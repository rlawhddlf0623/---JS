<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hide Input Example</title>
 
    <style>
      .Todo-container {
        width: 88%;
        height: 30px;
        padding: 0px 13px;
        margin: 5px;
        background-color: aliceblue;
        border-radius: 5px;
        display: flex;
        justify-content: space-between;

        align-items: center;
        text-align: center;
        font-size: 1.3rem;
        transition: all 0.5s ease-out;
      }

      .Todo-CheckBox {
        width: 15px;
        height: 15px;
        border: 1px solid black;
        border-radius: 50%;
        display: inline-block;
        line-height: 35px;
      }
      #Todo-text {
        display: inline-block;
        margin: 10px 0px;
        width: 70%;
      }
      .Todo-remove-button {
        color: red;
        cursor: pointer;
      }
      .container {
        /* position: relative; */
        width: 300px;
        height: 300px;
        margin: 20px;
        /* background-color: dodgerblue; */
        display: flex;
        flex-direction: column;
        border: 1px solid black;
      }
      .input {
        width: 100%;
        height: 0;
        opacity: 0;
        padding: 0;
        margin: 0;
        border: none;
      }
      @keyframes hideAnimation {
        0% {
          width: 100%;
          height: 30px;
          opacity: 1;
          padding: 0;
          margin: 0;
          border: 1px solid black;
        }
        100% {
          width: 100%;
          height: 0;
          opacity: 1;
          padding: 0;
          margin: 0;
          border: none;
        }
      }

      @keyframes showAnimation {
        0% {
          width: 100%;
          height: 0;
          opacity: 1;
          padding: 0;
          margin: 0;
          border: none;
        }
        100% {
          width: 100%;
          height: 30px;
          opacity: 1;
          padding: 0;
          margin: 0;
          border: 1px solid black;
        }
      }

      .hidden-input {
        animation: hideAnimation 0.5s forwards;
      }

      .visible-input {
        animation: showAnimation 0.5s forwards;
      }

      .hidden {
        display: none;
      }
      .input-style {
        /* 클릭 시 외곽선 제거 */
        outline: none;
      }
      .input-style,
      .editable-heading {
        width: 100%;
        height: 30px;

        padding: 0;
        margin: 0;
        border: 1px solid black;
        font-size: 1em;
        font-family: Arial, sans-serif;
        color: #333;
        box-sizing: border-box; /* 패딩과 테두리가 요소의 전체 크기에 포함되도록 */
      }
      .Todo-box {
        position: relative;
      }
    </style>
  </head>
  <body>
    <h6 class="editable-heading">1</h6>

    <div class="container"></div>
    <button onclick="createToDo()">todo 생성</button>
    <h6>qus</h6>

  </body>
  <script>
    // document.addEventListener('DOMContentLoaded', () => {
    //     const heading = document.querySelector('.editable-heading');
    //         heading.addEventListener('click', () => {
    //             // Create input element
    //             const input = document.createElement('input');
    //             input.type = 'text';
    //             input.value = heading.textContent;
    //             input.className = 'input-style';

    //             // Hide the heading and insert the input
    //             heading.style.display = 'none';
    //             heading.parentNode.insertBefore(input, heading);

    //             // Focus on the input
    //             input.focus();

    //             // Event handler for blur and enter key press
    //             const handleInputChange = () => {
    //                 heading.textContent = input.value;
    //                 heading.style.display = 'block';
    //                 input.remove();
    //             };

    //             // Add event listeners
    //             input.addEventListener('blur', handleInputChange);
    //             input.addEventListener('keydown', (event) => {
    //                 if (event.key === 'Enter') {
    //                     input.blur();
    //                 }
    //             });
    //         });

    // });

    const container = document.querySelector(".container");
    container.addEventListener("click", (event) => {
      const TodoContainer = event.target.closest(".Todo-container");
      if (!TodoContainer) return;

      const TodoText = TodoContainer.querySelector(".Todo-text");

      if (TodoText) {
        const h6 = TodoContainer.nextElementSibling;

        // Toggle animation class
        if (h6.classList.contains("hidden-input")) {
          h6.classList.remove("hidden-input");
          //   void h6.offsetWidth; // Trigger reflow
          h6.classList.add("visible-input");
        } else {
          h6.classList.remove("visible-input");
          //   void h6.offsetWidth; // Trigger reflow
          h6.classList.add("hidden-input");
        }

        function executeAfterDelay() {
          // h6 요소의 크기와 위치를 복사
          const rect = h6.getBoundingClientRect();
          const parentRect = h6.parentNode.getBoundingClientRect();

          //  input생성
          const input = document.createElement("input");
          input.type = "text";
          input.value = h6.textContent;
          input.className = "input-style";

          // input 을 h6 위치에 놓기
          input.style.position = "absolute";
          input.style.top = `${rect.top - parentRect.top}px`;
          input.style.left = `${rect.left - parentRect.left}px`;
          input.style.height = `${rect.height}px`;

          // h6 요소를 숨기고 그 자리에 input 요소 삽입
          h6.parentNode.appendChild(input);
          h6.style.opacity = "0";
          h6.style.height = "0";

          input.focus();

          const handleInputChange = () => {
            TodoText.textContent = input.value;
            h6.style.opacity = "1";
            h6.style.height = "30px";
            input.remove();

            if (h6.classList.contains("hidden-input")) {
              h6.classList.remove("hidden-input");
              h6.classList.add("visible-input");
            } else {
              h6.classList.remove("visible-input");
              h6.classList.add("hidden-input");
            }
          };
          // Add event listeners
          input.addEventListener("blur", handleInputChange);
          input.addEventListener("keydown", (event) => {
            if (event.key === "Enter") {
              input.blur();
            }
          });
        }
        setTimeout(executeAfterDelay, 500);
      }
    });

    function createToDo(i) {
      let newTodo = `
                      <div class="Todo-box">
                          <div class="Todo-container" >
                              <div class="Todo-CheckBox"></div>
                              <h6 class="Todo-text">${i}번째 todo</h6>
                              <span class="Todo-important-button">☆</span>
                              <span class="Todo-remove-button">X</span>
                          </div>
                          <h6 type="text" class="input hidden-input"> </h6>
                        </div>
                          `;
      container.innerHTML += newTodo;
    }
    for (let i = 0; i < 8; i++) {
      createToDo(i);
    }
  </script>
</html>
